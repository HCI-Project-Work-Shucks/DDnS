# Summary

The Donut API is organized around REST. The API has predictable resource-oriented URLs, accepts form-encoded request bodies, returns JSON-encoded responses, and uses standard HTTP response codes authentication, and verbs.

# Authentication

A token is an authorization key that cannot be tampered with. It is generated by the server using a secret key, sent to and stored by the user in their local storage. Like in the case of cookies, the user sends this token to the server with every new request, so that the server can verify its signature and authorize the requests.

# Errors

Donut uses conventional HTTP response codes to indicate the success or failure of an API request. In general: Codes in the 2xx range indicate success. Codes in the 4xx range indicate an error that failed given the information provided (e.g., a required parameter was omitted). Codes in the 5xx range indicate an error with Donut's servers (these should be really rare).

## HTTP status code summary

- 200 - OK

  Everything worked as expected.

- 400 - Bad Request

  The request was unacceptable, often due to missing a required parameter.

- 401 - Unauthorized

  N/A

- 403 - Forbidden

  Doesn't have permissions.

- 404 - Not Found

  N/A

- 5xx - Server Errors

  Something went wrong on Donut' server end. (These should be really rare)

## The error object

### Attributes

- message (string)

  A human-readable message providing more details about the error. 

- code (integer)

  For some errors that could be handled programmatically, a short string indicating the error code reported.


# Users

This object represents a user of Donut.

## Endpoints

- POST /api/v1/users
- GET /api/v1/users/:id
- GET /api/v1/users/:id/addresses (ref Addresses section)
- GET /api/v1/users/:id/demand (ref Demands section)
- GET /api/v1/users/:id/donation (ref Donations section)


## The user object

### Attributes

- id (integer)

  Unique identifier for the object.

- name (string)

  The user's full name.

- phone (string)

  The user's phone number.

- email (string)

  The user's email address.

- verified (bool)

  Has the value TRUE if the user has verified its real identifity.

## Create a user

### POST /api/v1/users

### Parameters

- email (required)

  The user's email address.

- password (required)

  The user's password in plain text.

### Response

The user object.

## Update a user

### PUT /api/v1/users/:id

### Parameters

- password (optional)

  The user's password in MD5 hashes.

- name (optional)

  The user's full name.

- phone (optional)

  The user's phone number.

### Response

The user object.

# Addresses

This object represents a user's addresses.

## Endpoints

- POST /api/v1/addresses
- PUT /api/v1/addresses/:id
- DELETE /api/v1/addresses/:id
- GET /api/v1/users/:owner/addresses

## The address object

### Attributes

- id (integer)

  Unique identifier for the object.

- owner (integer)

  The address' owner ID.

- title (string)

  The address' brief title.

- desc (string)

  The description of the address.

- postcode (integer)

  The address' postcode number.

## Create an address

### POST /api/v1/addresses

### Parameters

- title (required)

  The address' brief title.

- desc (required)

  The description of the address.

- postcode (required)

  The address' postcode number.

### Response

The address object.

## Update an address

### PUT /api/v1/addresses/:id

### Parameters

- title (optional)

  The address' brief title.

- desc (optional)

  The description of the address.

- postcode (optional)

  The address' postcode number.

### Response

The address object.

## Delete an address

### DELETE /api/v1/addresses/:id

### Parameters

N/A

### Response

Returns an object with a deleted parameter on success, if the uid/aid does not exist, this call returns an error object.

```json
{
  "id": "987654321",
  "object": "address",
  "deleted": true
}
```

## List a user's all addresses

### GET /api/v1/users/:uid/addresses

### Parameters

N/A

### Response

A dictionary with a **data** property that contains an array of a user's all addresses. Each entry in the array is a separate address object. If no more addresses are available, the resulting array will be empty.

```json
{
  "object": "list",
  "url": "/api/v1/users/:uid/addresses",
  "has_more": false,
  "data": [
    {...},
    {...},
    {...}
  ]
}
```

# Demands

This object represents an article which demands by a user.

## Endpoints

- POST /api/v1/demands

## The demand object

- id (integer)

  Unique identifier for the object.

- category (integer)

  The article's category, e.g., Food, Bags, Clothes.

- title (string)

  The article's brief title.

- quantity (integer)

  How many articles the needy wants.

- desc (string)

  The article's description, it can be described arbitrary inforation about the article.

- images (array)

  Images' information for the demand.

## Publish a demand

### POST /api/v1/demands

### Parameters

- category (required)

  The article's category, e.g., Food, Bags, Clothes.

- title (required)

  The article's brief title.

- Quantity (required)

  How many archticles the user wants.

- desc (required)

  The article's description.

### Response

The demand object.

# Donations

This object represents an article which donates by a user.

## Endpoints

- POST /api/v1/donations

## The donation object

As same as demand object.

## Publish a donation

### POST /api/v1/donations

### Parameters

As same as demand publishing parameters.

### Response

The donation object.

# Fulfilments

This object reprents willingness to fulfil a demand/donation.

## The fulfilment object

- id (integer)

  Unique identifier for the object.

- target_type (string)

  Indicates the target type that the filfilment wants to satisfy, **demand** or **donation**.

- target_id (integer)

  The demand or donation ID.

- creator (integer)

  The ID of the object's creator.

- status (string)

  One of pending, accepted, delivering, completed.

## Endpoints

- POST /api/v1/fulfilments
- PUT /api/v1/fulfilments/:id

## Create: show willingness to fulfil a demand or donation

### POST /api/v1/fulfilments

### Parameters

- target_type (required string)

  A demand or donation that a user wants to fulfil.

- target_id (required integer)

  The demand or donation ID.

### Response

The fulfilment object.

## Complete: appreciate a fulfilment which has been fulfilled

### PUT /api/v1/fulfilments/:id

### Parameters

- target_type (required string)

  A demand or donation that a user wants to appreciate.

- target_id (required integer)

  The demand or donation ID.

### Response

The fulfilment object.

# Images

The object represents an image which binds to a demand/donation/user or whatever objects.

## The image object

- id (integer)

  Unique identifier for the object.
  
- target_type (string)

  The target type that the image binds to. One of **demand**, **donation**, **fulfilment**, and **user**.
  
- target_id (integer)

  The target ID.

## Endpoints

- POST /api/v1/images

## Upload images

### POST /api/v1/images

### Parameters

N/A

### Response

A dictionary with a **data** property that contains an array of images. Each entry in the array is a separate image object.

```json
{
  "object": "<demand | donation | fulfilment | user>_image",
  "url": "/api/v1/images",
  "has_more": false,
  "data": [
    {...},
    {...},
    {...}
  ]
}
```

